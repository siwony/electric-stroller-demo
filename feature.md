# Stroller Demo App — Feature Spec (v1.1)
Android Only / BLE & HW 통신 제외 / 데모용 UI

---

## 0. 목적
- 안드로이드 단일 플랫폼에서 유모차 **대여/반납** 경험을 시연하기 위한 **UI 데모 앱**.
- 실제 BLE/네트워크 통신 없이 **Mock 데이터/상태**를 기반으로 화면 전환 및 진행 단계를 재현.
- 시연자는 각 단계에서 직접 유모차를 **수동으로 잠금/해제**.

---

## 1. 범위 (In Scope)
- 화면: 스플래시(형식), 홈, 대여 진행, 대여중 상태, 반납 진행, 반납 완료, 공통 오류/안내, 설정
- 네비게이션: 홈 중심의 단방향 플로우
- 상태관리: In-Memory (ViewModel + SavedState)
- Mock: 단계별 지연(10초), 수동 성공/실패 전환(`forceFail`)
- 로깅: 화면 진입 및 버튼 클릭(Logcat)

---

## 2. 비범위 (Out of Scope)
- BLE(GATT), 위치 권한, 실제 잠금장치 제어
- 서버/백엔드 연동, 로그인/결제
- 다국어, iOS 지원, 디자인 고도화

---

## 3. 핵심 사용자 여정
1. 앱 실행 → 홈
2. “대여하기” → (10초 단위 진행 단계 표시) → “대여중”
3. “반납하기” → (10초 단위 진행 단계 표시) → “반납 완료” → 홈

---

## 4. 화면 정의

### 4.1 스플래시/권한 안내
- 요소: 앱 타이틀, “데모용으로 권한 없이 진행됩니다” 문구, “시작하기” 버튼
- 액션: 시작하기 → 홈

### 4.2 홈
- 상단 AppBar: 타이틀, (좌) 설정, (우) 도움말(토스트)
- 본문:
    - Primary 버튼: 대여하기
    - Secondary 버튼: 반납하기 (대여중일 때만 활성)
    - 상태 라벨: “데모 모드 / 네트워크 모의”
- 디버그 패널(**필수**):
    - 지연시간(ms) 입력 (기본값 10000)
    - 강제 실패 옵션(`forceFail`) 토글

---

### 4.3 대여 진행
- 단계 표시 (텍스트 및 인디케이터):
  1️⃣ **유모차와 연결 중...**  
  2️⃣ **사용자 인증 중...**  
  3️⃣ **잠금 장치 해제 중...**  
  4️⃣ **대여 완료!**
- 각 단계는 **약 10초 간격**으로 전환됨 (수동 해제 시연용)
- 진행 바/스피너 + 현재 단계 텍스트 표시
- 실패 시: “연결 실패. 다시 시도해주세요.” 다이얼로그
- 완료 시 자동 전환 → 대여중

---

### 4.4 대여중
- 카드 정보:
    - 유모차 ID (Mock 생성)
    - 대여 시작 시각
    - 경과 시간(타이머)
- 버튼: 반납하기

---

### 4.5 반납 진행
- 단계 표시 (텍스트 및 인디케이터):
  1️⃣ **유모차와 연결 중...**  
  2️⃣ **유모차 상태 확인 중...**  
  3️⃣ **잠금 장치 잠그는 중...**  
  4️⃣ **반납 완료!**
- 각 단계는 **약 10초 간격**으로 전환됨 (수동 잠금 시연용)
- 실패 시: 재시도/도움말
- 완료 시: 반납 완료 화면

---

### 4.6 반납 완료
- 체크 아이콘 + 요약(유모차 ID, 이용 시간)
- 버튼: 홈으로 (2초 후 자동 홈 이동)

---

### 4.7 설정
- 항목:
    - 데모 모드 안내
    - 로그/진단 내보내기(토스트)
    - 약관/개인정보 처리방침(더미 다이얼로그)

---

### 4.8 공통 오류/안내
- 다이얼로그: 제목, 설명, CTA(다시시도/취소)
- 예시: “유모차에 가까이 가서 다시 시도해주세요.”

---

## 5. 상호작용 규칙
- 뒤로가기: 진행 중이면 “진행을 취소할까요?” 다이얼로그 노출
- 반납 완료 화면은 2초 후 자동 홈 복귀

---

## 6. 상태 모델
```kotlin
enum class RentalState { IDLE, RENTING, RENTED, RETURNING, RETURNED, ERROR }

data class UiState(
    val rentalState: RentalState = IDLE,
    val strollerId: String? = null,
    val startAt: Long? = null,
    val elapsedSec: Int = 0,
    val progressStep: Int = 0, // 0: Idle, 1~4 = 진행 단계 (1단계=연결 중, 4단계=완료)
    val mockDelayMs: Long = 10_000L,
    val forceFail: Boolean = false,
    val errorCode: String? = null,
)
```

## 7. 디자인 정책

흰 배경, 검은 텍스트, Primary 한 색상만 사용

시스템 기본 폰트

버튼 간 충분 간격, 단순한 레이아웃 유지

## 8. 로깅(데모용)

화면 진입: ScreenView(name)

버튼 클릭: Click(name)

단계 진행: Flow(step, screen)

실패 발생: FlowError(code, atStep)

## 9. 접근성

주요 컨트롤에 contentDescription 지정

단계 표시 시 “4단계 중 2단계” 음성 출력 가능

## 10. 위험 및 대응

진행 중 앱 이탈 → 확인 다이얼로그

각 단계는 10초 전이, 타임아웃 10초

프리즈 방지: Coroutine 기반 delay로 UI 비동기 처리

## 11. 릴리스 계획
| 버전   | 주요 내용                                            |
| ---- | ------------------------------------------------ |
| v1.0 | 홈/대여/반납 플로우 + 10초 지연 UI                          |
| v1.1 | 실패 다이얼로그 + 재시도 + **디버그 패널(forceFail, delay 설정)** |
| v1.2 | 자동 홈 복귀, UI 폴리싱                                  |
